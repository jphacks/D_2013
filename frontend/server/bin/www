#!/usr/bin/env node

/**
 * サーバの設定
 */

// モジュールのロード
const app = require('../server');
const http = require('http');

let ws = require('ws');
var server = new ws.Server({ port: 4040 });

server.on('connection', ws => {
    ws.on('message', message => {
        console.log(message);
    });
    ws.send('This is server');
});

// ポートの設定を行う
const port = process.env.PORT || 4040;
app.set('port', port);

// サーバオブジェクトを生成する
const server = http.createServer(app);

// Socket.IOの処理
require('../sockets')(server);

// 接続を待ち受ける
server.listen(port);
server.on('listening', onListening);

function onListening() {
    // ログ出力
    console.log('Example app listening on port ' + port + '!');
}
